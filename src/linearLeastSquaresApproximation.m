% Author: Derek Drake & Mark Forget
% Date: 04/22/2021
% CSCE-440
%
% This is a program will:
%      (1) Find the linear least square approximation for a given data set.
%      (2) Plot the approximation

 
% arrays of data points
battingAverage=[0.272,0.269,0.249,0.26,0.273,0.291,0.258,0.228,0.25,0.203,0.262,0.222,0.227,0.261,0.3,0.225,0.255,0.29,0.246,0.208,0.238,0.267,0.353,0.213,0.302,0.26,0.255,0.259,0.223,0.225,0.258,0.275,0.327,0.272,0.241,0.293,0.257,0.225,0.196,0.252,0.294,0.297,0.258,0.205,0.272,0.243,0.337,0.228,0.24,0.298,0.249,0.292,0.265,0.265,0.289,0.295,0.27,0.246,0.288,0.273,0.239,0.244,0.275,0.34,0.25,0.272,0.219,0.24,0.285,0.307,0.24,0.264,0.227,0.305,0.28,0.251,0.216,0.243,0.319,0.297,0.251,0.253,0.275,0.32,0.259,0.275,0.249,0.188,0.241,0.242,0.251,0.302,0.28,0.256,0.301,0.281,0.234,0.26,0.267,0.318,0.216,0.286,0.253,0.295,0.285,0.262,0.214,0.218,0.294,0.254,0.243,0.153,0.265,0.235,0.296,0.264,0.294,0.287,0.278,0.222,0.248,0.268,0.214,0.195,0.278,0.267,0.317,0.272,0.265,0.262,0.194,0.217,0.228,0.286,0.269,0.246,0.275,0.243,0.301,0.312,0.268,0.262,0.221,0.175,0.238,0.264,0.225,0.123,0.246,0.24,0.115,0.12,0.227,0.323,0.278,0.263,0.26,0.216,0.233,0.204,0.23,0.243,0.233,0.278,0.269,0.3,0.249,0.229,0.332,0.231,0.251,0.262,0.283,0.258,0.225,0.263,0.295,0.26,0.457,0.262,0.243,0.224,0.217,0.288,0.243,0.258,0.209,0.284,0.282,0.249,0.264,0.261,0.263,0.248,0.279,0.179,0.284,0.247,0.237,0.26,0.259,0.257,0.289,0.291,0.216,0.325,0.26,0.289,0.213,0.286,0.283,0.244,0.311,0.206,0.265,0.238,0.364,0.316,0.288,0.268,0.225,0.267,0.247,0.285,0.245,0.23,0.22,0.242,0.238,0.308,0.273,0.252,0.295,0.282,0.262,0.25,0.244,0.234,0.216,0.25,0.243,0.256,0.275,0.246,0.238,0.296,0.263,0.258,0.2,0.211,0.203,0.293,0.285,0.304,0.268,0.259,0.273,0.241,0.284,0.246,0.318,0.274,0.241,0.165,0.281,0.251,0.217,0.225,0.301,0.259,0.255,0.301,0.272,0.25,0.277,0.28,0.252,0.188,0.277,0.261,0.217,0.251,0.216,0.271,0.284,0.319,0.277,0.311,0.265,0.279,0.31,0.286,0.303,0.281,0.286,0.283,0.307,0.268,0.201,0.276,0.274,0.295,0.063,0.238,0.226,0.261,0.249,0.249,0.238,0.235,0.256,0.248,0.254,0.194,0.327,0.244,0.305,0.307,0.23,0.247,0.205,0.216,0.266,0.322,0.341,0.278,0.271,0.252,0.264,0.269,0.194,0.213,0.111,0.264,0.187,0.264,0.258];

salary=[3300,2600,2500,2475,2313,2175,600,460,240,200,177,140,117,115,2600,1907,1190,990,925,365,302,300,129,111,6100,4125,3213,2319,2000,1600,1394,935,850,775,760,629,275,120,2567,2500,2350,2317,2000,715,660,650,260,250,200,180,180,5150,4450,2000,1850,1192,875,825,525,367,325,320,150,113,113,2425,2367,2050,2000,1617,1167,992,400,315,315,230,135,130,3150,2785,2700,2400,1750,1262,940,555,500,370,350,148,146,4350,2833,2833,2750,1550,1300,1000,750,430,260,120,1500,1458,1210,935,800,395,350,285,139,133,4050,3600,3333,2183,1150,840,587,400,350,135,135,135,4075,3300,2387,2100,1750,805,725,687,200,130,125,120,117,114,4275,3563,2000,1600,1533,940,850,650,360,150,145,140,109,109,3415,2100,1300,1200,1025,730,687,380,365,175,150,150,140,3050,2900,2850,2700,2400,2300,1650,1600,1075,550,350,340,155,145,950,700,550,525,525,333,325,300,200,175,158,145,4500,3358,2400,2200,2017,1567,1050,375,355,300,230,150,120,109,3453,3200,2530,2167,1150,750,500,395,300,284,230,109,5300,3620,2500,2167,2150,1950,1300,360,280,255,147,125,109,3742,3633,2983,2383,2300,1375,1000,1000,900,775,600,387,117,2700,2317,1650,640,190,170,135,130,130,3650,3575,3500,2500,1900,1350,740,650,620,565,235,225,200,145,120,109,4200,3417,3100,1650,1150,900,740,575,425,400,287,275,183,170,153,109,3100,2992,2800,2500,1933,1200,1075,950,450,360,175,155,5000,3250,2825,2600,2050,1583,1150,1100,760,525,500,205,185,115,3750,2188,2167,2167,2050,1445,875,560,360,162,133,109,4300,3850,2387,950,675,600,287,230,215,183,170,160,142,140,109];
salarySize=length(salary);

% the sum of batting average
sumBattingAverage=MySum(battingAverage);

% the sum of (batting average)^2
battingAverageSquared=battingAverage.^2;
sumBattingAverageSquared=MySum(battingAverageSquared);

% the sum of salary
sumy1=MySum(salary);

% the sum of (battingAverage * salary)
battingAverageAndSalary=battingAverage.*salary;
sumBattingAverageAndSalary=MySum(battingAverageAndSalary);

% set the linear system in matrix form
A=[salarySize sumBattingAverage; sumBattingAverage sumBattingAverageSquared];
b=[sumy1; sumBattingAverageAndSalary];

% solve the linear system 
x=A\b;
fhat=@(t) x(1) + x(2)*t;
SumLeastSquares=MySum(((fhat(battingAverage) - salary)).^2);

% calculate error
Err1= sqrt((1/salarySize)*SumLeastSquares);
fprintf('The Error for the first order approximation is: %10.8e\n',Err1);

%check with Matlab built-in
P=polyfit(battingAverage,salary,1);
fMatlab=polyval(P,battingAverage);
ErrMatlab=norm(fhat(battingAverage)-fMatlab,inf);
fprintf('The Error with Matlab is: %10.8e\n',ErrMatlab);

% plot the function
xx=0:0.001:0.450;
plot(battingAverage,salary,'ro','MarkerSize',4,'MarkerFaceColor','r');
hold on
plot(xx, fhat(xx),'b-');
title('Linear Least Squares Approximation Fit')
legend({'data','$\hat{f}$'},'interpreter','latex','Location','best')
xlabel('x')
ylabel('y')

% get the sum of a given array
function [ sum ] = MySum( array)

sum=0;
for i=1:length(array)
    sum= sum + array(i);
end
end
